services:
  postgres:
    image: postgres:15-alpine
    environment: [POSTGRES_PASSWORD=password]
  backend:
    build:
      context: ./apps/backend
      dockerfile: Dockerfile.dev
    volumes: [ "./apps/backend:/app", "~/.kube:/root/.kube:ro", "./infrastructure:/infrastructure:ro" ]
    ports: ["8000:8000"]
    # extra_hosts:
    #   - "host.docker.internal:host-gateway"
  frontend:
    build:
      context: ./apps/frontend
      dockerfile: Dockerfile.dev
    volumes: [ "./apps/frontend:/app", "/app/node_modules" ]
    environment: { VITE_API_URL: "http://localhost:8000" }
    ports: ["5173:5173"]
